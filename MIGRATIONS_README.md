# üîÑ –°–∏—Å—Ç–µ–º–∞ –º–∏–≥—Ä–∞—Ü–∏–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

–ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å —Å—Ö–µ–º—ã –ë–î –∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.

## –§–∞–π–ª—ã —Å–∏—Å—Ç–µ–º—ã –º–∏–≥—Ä–∞—Ü–∏–π

- `bot/migrations.py` - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π
- `migrate_add_profit_no_fees.py` - —Å—Ç–∞—Ä—ã–π —Å–∫—Ä–∏–ø—Ç (–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å)

## –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é

### 1. –î–æ–±–∞–≤–∏—Ç—å –≤ bot/migrations.py

**–î–ª—è MySQL** (–≤ —Ñ—É–Ω–∫—Ü–∏–∏ `apply_mysql_migrations()`):
```python
# –ú–∏–≥—Ä–∞—Ü–∏—è N: –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
if add_column_if_not_exists(cur, "trades", "new_column", "VARCHAR(255)"):
    migrations_applied += 1
```

**–î–ª—è SQLite** (–≤ —Ñ—É–Ω–∫—Ü–∏–∏ `apply_sqlite_migrations()`):
```python
# –ú–∏–≥—Ä–∞—Ü–∏—è N: –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è  
if add_column_if_not_exists(cur, "trades", "new_column", "TEXT"):
    migrations_applied += 1
```

### 2. –ü—Ä–∏–º–µ—Ä—ã —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö

| –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | MySQL | SQLite |
|------------|-------|---------|
| –°—Ç—Ä–æ–∫–∞ | `VARCHAR(255)` | `TEXT` |
| –ß–∏—Å–ª–æ | `DECIMAL(20,8)` | `REAL` |
| –¶–µ–ª–æ–µ | `INT` | `INTEGER` |
| –î–∞—Ç–∞/–≤—Ä–µ–º—è | `DATETIME` | `TEXT` |
| –õ–æ–≥–∏—á–µ—Å–∫–æ–µ | `BOOLEAN` | `INTEGER` |

### 3. –ü—Ä–∏–º–µ—Ä –º–∏–≥—Ä–∞—Ü–∏–∏

```python
# –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–æ–ª–±–µ—Ü –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ —Å–¥–µ–ª–∫–∏
if add_column_if_not_exists(cur, "trades", "status", "VARCHAR(20) DEFAULT 'completed'"):
    migrations_applied += 1

# –î–æ–±–∞–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É –Ω–∞—Å—Ç—Ä–æ–µ–∫
cur.execute("""
CREATE TABLE IF NOT EXISTS settings (
    key_name VARCHAR(50) PRIMARY KEY,
    value TEXT,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
)
""")
```

## –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã

‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ú–∏–≥—Ä–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª—è—é—Ç —Å—Ç–æ–ª–±—Ü—ã, –Ω–µ —É–¥–∞–ª—è—é—Ç  
‚úÖ **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –º–Ω–æ–≥–æ —Ä–∞–∑ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: –í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞  
‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ª–æ–≥–∏  

## –ö–∞–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —É–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã

1. **profit_no_fees** - —Å—Ç–æ–ª–±–µ—Ü –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ë–ï–ó –∫–æ–º–∏—Å—Å–∏–π
2. **–ò–Ω–¥–µ–∫—Å—ã** - –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
3. **–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á** - –¥–ª—è request_id (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ SQLite
USE_MYSQL=false python3 bot/migrations.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ (Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
# –°–º–æ—Ç—Ä–∏–º –ª–æ–≥–∏ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
```

## –í –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å

- –°—Ç–æ–ª–±–µ—Ü `execution_time` –¥–ª—è –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–¥–µ–ª–∫–∏
- –¢–∞–±–ª–∏—Ü—É `bot_settings` –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –°—Ç–æ–ª–±–µ—Ü `strategy_version` –¥–ª—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ...

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ª—é–±—ã–º –∏–∑–º–µ–Ω–µ–Ω–∏—è–º —Å—Ö–µ–º—ã –ë–î! üöÄ
